# Active Context - –¢–µ–∫—É—â–∏–π —Å—Ç–∞—Ç—É—Å –ø—Ä–æ–µ–∫—Ç–∞

**–ü–æ—Å–ª–µ–¥–Ω–µ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ:** 2026-01-16

## üéØ –ì–¥–µ –º—ã —Å–µ–π—á–∞—Å

**–ó–∞–≤–µ—Ä—à–µ–Ω–Ω—ã–π —ç—Ç–∞–ø:** –≠—Ç–∞–ø 3.5 (BotPic Upload) - ‚úÖ DONE

**–¢–µ–∫—É—â–∏–π —Å—Ç–∞—Ç—É—Å:**
- ‚úÖ –≠—Ç–∞–ø 1: Visual Foundation - COMPLETED
- ‚úÖ –≠—Ç–∞–ø 2: Validation & Feedback - COMPLETED
- ‚úÖ –≠—Ç–∞–ø 3: Avatar Upload - COMPLETED
- ‚úÖ –≠—Ç–∞–ø 3.5: BotPic Upload - COMPLETED (—Ç–æ–ª—å–∫–æ —á—Ç–æ!)

**–ß—Ç–æ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ –≤ –≠—Ç–∞–ø–µ 3:**
- –ö–æ–º–ø–æ–Ω–µ–Ω—Ç AvatarUpload —Å drag & drop
- –í–∞–ª–∏–¥–∞—Ü–∏—è –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π (—Ñ–æ—Ä–º–∞—Ç, —Ä–∞–∑–º–µ—Ä, —Ä–∞–∑—Ä–µ—à–µ–Ω–∏–µ, –∫–≤–∞–¥—Ä–∞—Ç–Ω–æ—Å—Ç—å)
- Preview –∞–≤–∞—Ç–∞—Ä–∞ –≤–æ –≤—Å–µ—Ö preview –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–∞—Ö
- –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ –¥–ª—è –ø—Ä–æ—Å–º–æ—Ç—Ä–∞ –≤ –ø–æ–ª–Ω–æ–º —Ä–∞–∑–º–µ—Ä–µ
- –ö–Ω–æ–ø–∫–∞ —É–¥–∞–ª–µ–Ω–∏—è –∞–≤–∞—Ç–∞—Ä–∞
- –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å App.tsx –∏ state management

**–ß—Ç–æ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ –≤ –≠—Ç–∞–ø–µ 3.5:**
- –ö–æ–º–ø–æ–Ω–µ–Ω—Ç BotPicUpload —Å drag & drop
- –í–∞–ª–∏–¥–∞—Ü–∏—è –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è (—Ç–æ—á–Ω–æ 640x360px, 16:9, JPEG/PNG)
- Preview BotPic –Ω–∞ —Å—Ç–∞—Ä—Ç–æ–≤–æ–º —ç–∫—Ä–∞–Ω–µ (ChatStart)
- –û—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ —Å –ø—Ä–∞–≤–∏–ª—å–Ω—ã–º aspect ratio (16:9)
- –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å App.tsx –∏ state management
- –û–±–Ω–æ–≤–ª–µ–Ω–∞ —Å—Ö–µ–º–∞ –≤–∞–ª–∏–¥–∞—Ü–∏–∏ botSettings.ts

## üìã –°–ª–µ–¥—É—é—â–∏–µ —à–∞–≥–∏

### –≠—Ç–∞–ø 5: Persistence (IndexedDB)

**–ó–∞–¥–∞—á–∏:**
1. –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–æ–¥–¥–µ—Ä–∂–∫–∏ IndexedDB
2. –ê–≤—Ç–æ—Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ —á–µ—Ä–Ω–æ–≤–∏–∫–∞ (debounced, 2 —Å–µ–∫)
3. –í–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ
4. –ó–∞—â–∏—Ç–∞ –æ—Ç race condition (isHydrating state)
5. –ö–Ω–æ–ø–∫–∞ "–°–æ—Ö—Ä–∞–Ω–∏—Ç—å —á–µ—Ä–Ω–æ–≤–∏–∫" (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)
6. Graceful degradation –ø—Ä–∏ –æ—Ç—Å—É—Ç—Å—Ç–≤–∏–∏ IDB

## üí° –í–∞–∂–Ω—ã–µ —Ä–µ—à–µ–Ω–∏—è –ø–æ—Å–ª–µ–¥–Ω–∏—Ö —ç—Ç–∞–ø–æ–≤

**–≠—Ç–∞–ø 2 (–í–∞–ª–∏–¥–∞—Ü–∏—è):**
- –í–∞–ª–∏–¥–∞—Ü–∏—è —Ç–æ–ª—å–∫–æ –ø—Ä–∏ —ç–∫—Å–ø–æ—Ä—Ç–µ - –Ω–µ –±–ª–æ–∫–∏—Ä—É–µ–º –≤–≤–æ–¥ maxLength, –Ω–æ –ø–æ–¥—Å–≤–µ—á–∏–≤–∞–µ–º
- botName = Display Name - –ª—é–±—ã–µ —Å–∏–º–≤–æ–ª—ã (–∫–∏—Ä–∏–ª–ª–∏—Ü–∞, —ç–º–æ–¥–∑–∏), –ù–ï username
- Zod –±–µ–∑ React Hook Form - –∫–æ–º–ø—Ä–æ–º–∏—Å—Å –¥–ª—è –ø—Ä–æ—Å—Ç–æ—Ç—ã (—Ñ–æ—Ä–º–∞ —Å—Ç–∞—Ç–∏—á–Ω–∞—è)

**–≠—Ç–∞–ø 3 (Avatar):**
- –ù–∞—Ç–∏–≤–Ω—ã–π HTML5 drag & drop (–±–µ–∑ –±–∏–±–ª–∏–æ—Ç–µ–∫)
- –í–∞–ª–∏–¥–∞—Ü–∏—è File –≤ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–µ, –Ω–µ –≤ Zod —Å—Ö–µ–º–µ
- –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ –¥–ª—è full-size –ø—Ä–æ—Å–º–æ—Ç—Ä–∞ (–∫–ª–∏–∫ –ø–æ preview)
- Avatar –æ–ø—Ü–∏–æ–Ω–∞–ª–µ–Ω - fallback –Ω–∞ –ø–µ—Ä–≤—É—é –±—É–∫–≤—É botName

## üîó –°–≤—è–∑–∞–Ω–Ω—ã–µ —Ñ–∞–π–ª—ã

**–û—Å–Ω–æ–≤–Ω—ã–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã:**
- [src/App.tsx](../../src/App.tsx) - –≥–ª–∞–≤–Ω—ã–π –∫–æ–º–ø–æ–Ω–µ–Ω—Ç, state management
- [src/components/AvatarUpload.tsx](../../src/components/AvatarUpload.tsx) - –∑–∞–≥—Ä—É–∑–∫–∞ –∞–≤–∞—Ç–∞—Ä–∞
- [src/schemas/botSettings.ts](../../src/schemas/botSettings.ts) - Zod –≤–∞–ª–∏–¥–∞—Ü–∏—è

**Preview –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã:**
- [src/components/preview/TelegramPhone.tsx](../../src/components/preview/TelegramPhone.tsx)
- [src/components/preview/ChatListItem.tsx](../../src/components/preview/ChatListItem.tsx)
- [src/components/preview/BotProfile.tsx](../../src/components/preview/BotProfile.tsx)
- [src/components/preview/ChatStart.tsx](../../src/components/preview/ChatStart.tsx)
- [src/components/preview/FirstMessage.tsx](../../src/components/preview/FirstMessage.tsx)

**–î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è:**
- [docs/TechnicalDesignDocument.md](../../docs/TechnicalDesignDocument.md)
- [TODO.md](../../TODO.md)

## üìù –í–æ–ø—Ä–æ—Å—ã –¥–ª—è –Ω–æ–≤–æ–π —Å–µ—Å—Å–∏–∏

–ö–æ–≥–¥–∞ –Ω–∞—á–Ω–µ—Ç–µ —Ä–∞–±–æ—Ç—É, —Å–ø—Ä–æ—Å–∏—Ç–µ:

1. **"–ü—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–ª –≠—Ç–∞–ø 3.5 (BotPic Upload) - –µ—Å—Ç—å –±–∞–≥–∏ –∏–ª–∏ –∑–∞–º–µ—á–∞–Ω–∏—è?"**
2. **"–ò–¥–µ–º –Ω–∞ –≠—Ç–∞–ø 5 (IndexedDB Persistence) –∏–ª–∏ –≠—Ç–∞–ø 6 (Export & ZIP)?"**
3. **"–ò–ª–∏ —Å–Ω–∞—á–∞–ª–∞ —á—Ç–æ-—Ç–æ –¥–æ—Ä–∞–±–æ—Ç–∞—Ç—å –≤ —Ç–µ–∫—É—â–µ–º —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª–µ?"**
